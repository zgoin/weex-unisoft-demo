<template>
  <text class="icon-font" :style="mergeStyle" @click="itemClicked(name)">{{_icon}}</text>
</template>

<style scoped>
  .icon-font {
    color: #444444;
  }
</style>

<script>
  import Icon from './type';

  const dom = weex.requireModule('dom');

  export default {
    props: {
      name: {
        default: 'back',
        type: String
      },
      size: {
        default: 'small',
        type: String
      },
      iconStyle: {
        type: Object,
        default: () => ({})
      }
    },
    data: () => ({
      Icon
    }),
    beforeCreate () {
      dom.addRule('fontFace', {
        'fontFamily': "unisoft-iconfont",
        'src': "url('https://at.alicdn.com/t/font_2282197_n2dl1zgbw7e.ttf')"
      });
    },
    computed: {
      mergeStyle () {
        const { iconStyle, size } = this;
        let fontSize = '40px';
        switch (size) {
          case 'xs':
            fontSize = '20px';
            break;
          case 'small':
            fontSize = '40px';
            break;
          case 'medium':
            fontSize = '60px';
            break;
          case 'big':
            fontSize = '80px';
            break;
          default:
            fontSize = parseFloat(size)+'px';
        }
        let style = {
          fontFamily: 'unisoft-iconfont',
          fontSize: fontSize
        }
        for (const key in iconStyle) {
          if (Object.hasOwnProperty.call(iconStyle, key)) {
            style[key] = iconStyle[key];
          }
        }
        return style;
      },
      _icon() {
        return this.Icon[this.name] || this.name;
      }
    },
    methods: {
      itemClicked (name) {
        this.$emit('click', {
          name
        });
      }
    },
  }
</script>
